{"version":3,"file":"components-Grid-Grid-stories.7f610053.iframe.bundle.js","mappings":";;;;;;;;;;AAoHA;;;;AAKA;;;AAsBA;;;;AAIA;;;;;AAOA;;AAIA;;;AArCA;;;;AA8CA;;AAIA;;ACtIA;;;AAGA","sources":["webpack://my-app/./src/components/Grid/Cell.tsx","webpack://my-app/./src/components/Grid/Grid.tsx"],"sourcesContent":["import React, { FC } from 'react';\r\nimport styled from '@emotion/styled';\r\n\r\nimport {Cell as CellType, CellState, Coords } from '@/core/Field'\r\nimport { useMouseDown } from '@/components/hooks/useMouseDown';\r\n\r\nexport interface CellProps {\r\n    /**\r\n     * Cell status based on the CellType\r\n     */\r\n    children: CellType;\r\n    /**\r\n     * Cell coordinates\r\n     */\r\n    coords: Coords;\r\n    /**\r\n     * onClick by cell handler\r\n     */\r\n    onClick: (coords: Coords) => void;\r\n    /**\r\n     * onContextMenu by cell handler\r\n     */\r\n    onContextMenu: (coords: Coords) => void;\r\n};\r\n\r\nexport const isActiveCell = (cell: CellType): boolean =>\r\n    [CellState.hidden, CellState.flag, CellState.weakFlag].includes(cell);\r\n\r\nexport const Cell: FC<CellProps> = ({ children, coords, ...rest }) => {\r\n    const [mouseDown, onMouseDown, onMouseUp] = useMouseDown();\r\n\r\n    const onClick = () => rest.onClick(coords);\r\n\r\n    const onContextMenu = (elem: React.MouseEvent<HTMLElement>) => {\r\n        /**\r\n         * Prevent context menu by default\r\n         */\r\n        elem.preventDefault();\r\n\r\n        if(isActiveCell(children)) {\r\n            rest.onContextMenu(coords)\r\n        }\r\n    };\r\n\r\n    const props = {\r\n        onClick,\r\n        onContextMenu,\r\n        onMouseDown,\r\n        onMouseUp,\r\n        onMouseLeave: onMouseUp,\r\n        mouseDown,\r\n        'data-testid': `${coords}`,\r\n    };\r\n\r\n    return <ComponentsMap {...props}>{children}</ComponentsMap>\r\n};\r\n\r\ninterface ComponentsMapProps {\r\n    children: CellType;\r\n    onClick: (elem: React.MouseEvent<HTMLElement>) => void;\r\n    onContextMenu: (elem: React.MouseEvent<HTMLElement>) => void;\r\n    onMouseDown: () => void;\r\n    onMouseUp: () => void;\r\n    onMouseLeave: () => void;\r\n    mouseDown: boolean\r\n    'data-testid'?: string;\r\n}\r\n\r\nconst ComponentsMap: FC<ComponentsMapProps> = ({children, ...rest}) => {\r\n    const nonActiveCellProps = {\r\n        onContextMenu: rest.onContextMenu,\r\n        'data-testid': rest['data-testid']\r\n    };\r\n    \r\n    switch (children) {\r\n        case CellState.empty:\r\n            return <RevealedFrame  {...nonActiveCellProps} />;\r\n        case CellState.bomb:\r\n            return (\r\n                <BombFrame {...nonActiveCellProps}>\r\n                    <Bomb/>\r\n                </BombFrame>\r\n            );\r\n        case CellState.hidden:\r\n            return <ClosedFrame {...rest} />;\r\n        case CellState.flag:\r\n            return (\r\n                <ClosedFrame {...rest}>\r\n                    <Flag/>\r\n                </ClosedFrame>\r\n            );\r\n        case CellState.weakFlag:\r\n            return (\r\n                <ClosedFrame {...rest}>\r\n                    <WeakFlag />\r\n                </ClosedFrame>\r\n            );\r\n        default:\r\n            return <RevealedFrame {...nonActiveCellProps}>{children}</RevealedFrame>;\r\n    }\r\n};\r\n\r\ninterface ClosedFrameProps {\r\n    mouseDown?: boolean;\r\n}\r\n\r\nexport const ClosedFrame = styled.div<ClosedFrameProps>`\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    user-select: none;\r\n    cursor: pointer;\r\n    width: 1.8vw;\r\n    height: 1.8vw;\r\n    background-color: #d1d1d1;\r\n    border: 0.6vh solid transparent;\r\n    border-color: ${({mouseDown = false}) =>\r\n        mouseDown ? 'transparent' : 'white #9e9e9e #9e9e9e white'};\r\n    &:hover {\r\n        filter: brightness(1.1);\r\n    }\r\n`;\r\n\r\nconst transparent = 'rgba(0,0,0,0)';\r\nconst colors: { [key in CellType]: string } = {\r\n    0: '#000',\r\n    1: '#2a48ec',\r\n    2: '#2bb13d',\r\n    3: '#ec6561',\r\n    4: '#ec6561',\r\n    5: '#a6070f',\r\n    6: '#e400af',\r\n    7: '#906a02',\r\n    8: '#fa0707',\r\n    9: transparent,\r\n    10: transparent,\r\n    11: transparent,\r\n    12: transparent,\r\n};\r\n\r\nconst RevealedFrame = styled(ClosedFrame)`\r\n    border-color: #dddddd;\r\n    cursor: default;\r\n    color: ${({ children }) => colors[children as CellType] ?? transparent};\r\n    &:hover {\r\n        filter: brightness(1);\r\n    }\r\n`;\r\n\r\nconst Bomb = styled.div`\r\n    border-radius: 50%;\r\n    width: 1vw;\r\n    height: 1vw;\r\n    background-color: #333;\r\n`;\r\n\r\nconst BombFrame = styled(RevealedFrame)`\r\n    background-color: #ec433c;\r\n`;\r\n\r\nconst Flag = styled.div`\r\n    width: 0px;\r\n    height: 0px;\r\n    color: ${transparent};\r\n    border-top: 0.5vw solid transparent;\r\n    border-bottom: 0.5vw solid transparent;\r\n    border-left: 0.5vw solid #ec433c;\r\n`;\r\n\r\nconst WeakFlag = styled(Flag)`\r\n    border-left: 0.5vw solid #f19996\r\n`;","import React, { FC } from \"react\";\r\nimport styled from '@emotion/styled';\r\nimport { Coords, Field } from \"@/core/Field\";\r\nimport { Cell } from \"./Cell\";\r\n\r\nexport interface GridProps {\r\n    /*\r\n    * Field data\r\n    */\r\n    children: Field;\r\n    /*\r\n    * onClick handler\r\n    */\r\n    onClick: (coords: Coords) => void;\r\n    /*\r\n    * onContextMenu handler\r\n    */\r\n    onContextMenu: (coords: Coords) => void;\r\n}\r\n\r\nexport const Grid: FC<GridProps> = ({ children, ...rest}) => (\r\n    <Wrapper size={children.length}>\r\n        {children.map((row, y) => \r\n            row.map((cell, x) => \r\n                <Cell key={`${y}_${x}_${cell}`} coords={[y,x]} {...rest}>\r\n                    {cell}\r\n                </Cell>\r\n        ))}\r\n    </Wrapper>\r\n);\r\n\r\ninterface WrapperProps {\r\n    size: number;\r\n}\r\n\r\nconst Wrapper = styled.div<WrapperProps>`\r\n    display: grid;\r\n    grid-template-columns: repeat(${({size}) => size}, auto);\r\n    width: max-content;\r\n    padding: 1vw;\r\n`;"],"names":[],"sourceRoot":""}